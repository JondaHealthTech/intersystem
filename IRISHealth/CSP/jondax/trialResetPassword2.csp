<html>
<head>
	<script language="cache" method="OnPreHTTP" arguments="" returntype="%Boolean">
		i $g(%session.Data("UserID"))="" s %response.Redirect="trialLockDown.csp" q 1
		q 1
		</script>
    <script language="cache" runat="server">d HEADTRIAL^WSP999</script>
	<link rel="stylesheet" href="assets/styles/trialResetPassword2.css">
</head>
<body>
<form id="F1" autocomplete="off">
	<div id="wrapper">
	    <div class="bg-wrapper">
	        <div class="bg4">
	            <img src="./assets/images/bg4.png">
	        </div>
	    </div>
	    <div class="content">
	        <a href="https://www.jondax.eu/csp/jondax/trialLogin.csp"><img class="logo" src="./assets/images/trial/JXbyJx.png" alt="Jonda X"></a>
	        <div id="reset-form" class="reset-form">
				<img src="./assets/images/Mail.png" alt="Mail">
                <h3>Enter your verification code </h3>
                <h4>Please check your email for your verification code to reset your password.</h4>
	            <div style="padding-top:10px;background-color:#FFFFFF">				
					<div class="row">
						<div class="col-xs-12" style="background-color:#FFFFFF;text-align: center;">
							<div class="form-group text-center" style="padding-top:20px">
								<div style="text-align: center;">
									<input id="T1" name="T1" type="number" maxlength="1" onkeyup="autoTab('T1','1','T2')" onfocus="this.value=''" onkeydown="jBackSpace('T1','1','T1')" oninput="javascript: if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength);" style="width:40px;font-size:16pt;text-align:center;border:none;border-bottom:2px #405470 solid">
									<input id="T2" name="T2" type="number" maxlength="1" onkeyup="autoTab('T2','1','T3')" onfocus="this.value=''" onkeydown="jBackSpace('T2','1','T1')" oninput="javascript: if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength);" style="margin-left:10px;width:40px;font-size:16pt;text-align:center;border:none;border-bottom:2px #405470 solid">
									<input id="T3" name="T3" type="number" maxlength="1" onkeyup="autoTab('T3','1','T4')" onfocus="this.value=''" onkeydown="jBackSpace('T3','1','T2')" oninput="javascript: if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength);" style="margin-left:10px;width:40px;font-size:16pt;text-align:center;border:none;border-bottom:2px #405470 solid">
									<input id="T4" name="T4" type="number" maxlength="1" onkeyup="autoTab('T4','1','T5')" onfocus="this.value=''" onkeydown="jBackSpace('T4','1','T3')" oninput="javascript: if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength);" style="margin-left:10px;width:40px;font-size:16pt;text-align:center;border:none;border-bottom:2px #405470 solid">
									<input id="T5" name="T5" type="number" maxlength="1" onkeyup="autoTab('T5','1','T6')" onfocus="this.value=''" onkeydown="jBackSpace('T5','1','T4')" oninput="javascript: if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength);" style="margin-left:10px;width:40px;font-size:16pt;text-align:center;border:none;border-bottom:2px #405470 solid">
									<input id="T6" name="T6" type="number" maxlength="1" onkeyup="autoTab('T6','1','T6')" onfocus="this.value=''" onkeydown="jBackSpace('T6','1','T5')" oninput="javascript: if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength);" style="margin-left:10px;width:40px;font-size:16pt;text-align:center;border:none;border-bottom:2px #405470 solid">
								</div>							
							</div>
						</div>			
					</div>
					<div class="row">
						<p class="error-text" id="AlertText">
						<br>
	            		</p>	
	            	</div>
					<div class="row">
						<div class="col-xs-12" style="background-color:#FFFFFF;color:#000000;font-size:11pt;text-align: center;">
							<span>Didn't receive a code? </span><span style="color:#E63876;cursor: pointer;" onclick="jSendEmail()">Try Again</span>
						</div>				
					</div>
					<br>
					<div class="form-group text-center">
						<div class="col-xs-12">
							<div onclick="jValidateMe()" id="B1" name="B1" class="btn btn-block waves-effect waves-light">
								Verify
							</div>
						</div>
					</div>					
					<span class="form-group text-center" style="padding-top:30px">
						<span class="col-xs-12">
							<span id="AlertText" name="AlertText" style="color:#E63E7A; font-family:Montserrat; font-size:9px"></span>
						</span>
					</span>			
				</div>
	        </div>
	    </div>
	</div>
	<script type="text/javascript">var resizefunc = [];</script>
	<!-- jQuery  -->
	<script language="cache" runat="server">
		d jQueryCore^WSP999
	</script>
</form>
</body>
<script type="text/javascript">
	let mySessionEnd;	
	window.onload = resetTimer;
	document.onmousemove = resetTimer;
	document.onmousedown = resetTimer; 
	document.ontouchstart = resetTimer;
	document.onclick = resetTimer; 
	document.onkeypress = resetTimer;
	document.addEventListener('scroll', resetTimer, true); 

	T1=self.T1,T2=self.T2,T3=self.T3,T4=self.T4,T5=self.T5,T6=self.T6;
	const form= document.querySelector('.form-group');
	const inputs = form.querySelectorAll('input');
	const AlertText = document.querySelector('.error-text');
	
	function jBackSpace(field1, len, field2){
	
		if (window.event.keyCode==8){
			document.getElementById(field1).value=""
			document.getElementById(field2).focus();
		}
		if (window.event.keyCode==69){
			document.getElementById(field1).value=""
		}
	}

	function autoTab(field1, len, field2) {
		if (document.getElementById(field1).value.length == len) {
			document.getElementById(field2).focus();
		}
	}
	function jValidateMe(){
		if(T1.value!="" && T2.value!="" && T3.value!="" && T4.value!="" && T5.value!="" && T6.value!=""){
			const verifyCode=T1.value+T2.value+T3.value+T4.value+T5.value+T6.value;
			#server(..cCheckCode(verifyCode))#
		}
		else{
			AlertText.innerHTML="Please Enter Authenticator Code!"
		}
	}
	function resetInput(){
		inputs.forEach(input => {
   	 		input.value = ""; 
			});
	}
	function resetTimer(){
		clearTimeout(mySessionEnd);
		mySessionEnd = setTimeout(jLockDown, 3600000);
	}
	function clearTimer(){
		clearTimeout(mySessionEnd);
	}
	function jLockDown(){
		#server(..cLockDown())#
	}
	function jSendEmail(){
		#server(..cSendCodeAgain())#
	}
</script>
<script language="cache" method="cCheckCode" arguments="d1:%String">
	s mail=$g(%session.Data("Email"))
	s vCode=$g(^TrialUser(mail,"ResetPswd"))
	i vCode=d1 &js<window.open("trialResetPassword3.csp","_self")>
	else  &js<AlertText.innerHTML="Wrong Verification Code!"; resetInput();>
</script>
<script language="cache" method="cSendCodeAgain">
	s d1=%session.Data("Email")
	d ResetPassword^AutoMail
	s %session.Data("Email")=d1
</script>
<script language="cache" method="cLockDown">
	k %session.Data
	&js<window.open("trialLockDown.csp","_parent")>
</script>
</html>
