<html lang="en">
    <head>
	<script language="cache" method="OnPreHTTP" arguments="" returntype="%Boolean">
		i $g(%session.Data("UserID"))="" s %response.Redirect="jxLockDown.csp" q 1
		q 1
	</script>
	<script language="cache" runat="server">
		s id=$g(%session.Data("UserID"))
		d HEAD1^WSP999
	</script>
        <link rel="stylesheet" href="assets/styles/jxDemoFileUpload.css">
    </head>
    <body>
    
        <div id="loader" class="loader active">
        	<div class="loader-content">
        		<p >File Processing...</p>
            	<!--
            	<p >Data Mapping & Transforming...</p>
            	        		
        		<div class="lds-ring"><div>
        		</div><div></div><div></div><div></div></div>-->
        		 <img src="./assets/images/loader.gif" alt="Loading..." 
            	 style="width:80%;height:100%;">
        	</div>

        </div>  
          <div id="lab-upload" class="lab-upload">
                        <h4>Upload laboratory file</h4>
                        <img src="assets/images/upload.png" alt="Upload">
                        <p>
                            Drag and drop here<br>
                            or<br>
                        </p>
                        <input
                            type="file"
                            accept="image/*,.pdf,.hl7,.xml,.json,.xlsx"
                            id="fileupload"
                            style="display: none"
                            onchange="changeFile(event)"
                       >
                        <button onclick="openFileDialog(event)">Upload</button>
                        <p class="note">File Formats: PDF or <span style="text-decoration:underline;text-decoration-style:dotted;cursor:help" title="bmp, heic, jpg, jpeg, gif, webp">images</span></span>.<br>Max size: 5MB per file</p>
            </div>
          <div>          
            <button
                class="inactive"
                id="BModal1"
                data-toggle="modal"
                data-target="#myModal1"
                type="button"
            >
            </button>
              
        </div>
        <div
            id="myModal1"
            class="modal fade"
            aria-labelledby="myModalLabel"
            aria-hidden="true"
        >
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-body">
                        <h2>Hang tight!</h2>
                        <h3>We're analysing your file...</h3>
                        <img
                            class="modal-img"
                            src="assets/images/analyzeData.png"
                            alt="Analysing Data"
                       >
                    </div>
                </div>
            </div>
        </div>
	    <div id="popup1" class="popup inactive">
		<div class="popup-dialog">
			<!--<img src="./assets/images/trial/cross.png" alt="Close" class="close-btn" onclick="removePopup1()"> -->
			<h4 class="heading">Step 3</h4>
            <h4 class="heading">Data Mapping & Transforming...</h4>           
            <!--
            
            <span id="pbar">10%</span>
            <div class="progress">
			  <div id="progress-bar-fill" class="progress-bar progress-bar-striped progress-bar-animated" 
			       role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" 
			       style="width: 0%">0%
			  </div>
			</div> 
			<img src="./assets/images/success.png" alt="FYI">-->
		</div>
		</div> 
		<div id="popup2" class="popup inactive">
		<div class="popup-dialog">
			<!--<img src="./assets/images/trial/cross.png" alt="Close" class="close-btn" onclick="removePopup1()"> -->
			<h4 class="heading">Your file is ready!</h4>
            <h3 class="heading">Click OK to see the transformed results!</h3>
			
			<div class="btn-group">
                <button type="button" class="blue-btn" onclick='window.open("jxDemoTable.csp","_parent")'>OK</button>
            </div>
		</div>
		</div> 
        <script>
            var resizefunc = [];
        </script>
        <!-- jQuery  -->
		<script language="cache" runat="server">
			d jQueryCore^WSP999
		</script>
    </body>
    <script type="text/javascript">
		window.onload = parent.resetTimer;
  		document.onmousemove = parent.resetTimer;
  		document.onmousedown = parent.resetTimer; // touchscreen presses
  		document.ontouchstart = parent.resetTimer;
  		//document.onclick = parent.resetTimer; // touchpad clicks
  		document.onkeypress = parent.resetTimer;
  		document.addEventListener('scroll', parent.resetTimer, true);
  		window.onload=jInit
  		
		const popup1 = document.getElementById("popup1");
        const popup2 = document.getElementById("popup2");
  		
  		function jInit()
  		{
	  		#server(..cDMT())#
	  		}
	  		
	  	function openPopup1(){
    		/*
    		setTimeout(()=>{
      		popup1.classList.remove("inactive")
    			},100); */
			popup1.classList.remove("inactive");
		}
		function removePopup1(){
	    	popup1.classList.add("inactive");
		}
		 function openPopup2(){
    		setTimeout(()=>{
      		popup2.classList.remove("inactive")
    			},100);
		}
		function removePopup2(){
	    	popup1.classList.add("inactive");
	    	//window.location.reload();
		}	
  	</script>
  <script language="cache" method="cDMT">
  	s UserID=$g(%session.Data("UserID"))
  	h 3
  	if '$d(^jxDemo(UserID,"Done"))!$g(^jxDemo(UserID,"Done"))=0 {h 7 &js<window.location.reload()>}
  	else {d DMT^jxDemo
  			&js<loader.classList.add('inactive');openPopup2()>
  			}
  		
  </script>
  </html>