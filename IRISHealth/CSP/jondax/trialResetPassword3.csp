<!DOCTYPE html>
<html lang="en">
<head>
	<script language="cache" method="OnPreHTTP" arguments="" returntype="%Boolean">
		i $g(%session.Data("UserID"))="" s %response.Redirect="trialLockDown.csp" q 1
		q 1
		</script>
    <script language="cache" runat="server">d HEADTRIAL^WSP999</script>
	<link rel="stylesheet" href="assets/styles/trialResetPassword3.css">
</head>
<body>
	<div id="wrapper">
	    <div class="bg-wrapper">
	        <div class="bg4">
	            <img src="./assets/images/bg4.png">
	        </div>
	    </div>

     <div class="container">    
     	<img class="logo" src="./assets/images/trial/JXbyJx.png" alt="Jonda X">
      		<div class="form-container">  
        	<form id="F1" class="profile-form" autocomplete="off">
        	<img class="lock-img" src="./assets/images/trial/lock.png" alt="Lock">
			<h4>Let&apos;s set up your new password</h4>
            
             <!--   <div class="input-group">
                    <input type="text" name="T1" id="T1" placeholder="Enter your company email" required>
                </div> -->
                <div class="input-group">
                    <input type="password" name="T2" id="T2" placeholder="Enter New Password" onkeypress="jEnterKey(event)" required>
                    <img onclick="jTogglePassword(event)" src="./assets/images/eyeClose.png">
                </div>
                <div class="input-group">
                    <input type="password" name="T3" id="T3" placeholder="Confirm New Password" onkeypress="jEnterKey(event)" required>
                    <img onclick="jTogglePassword(event)" src="./assets/images/eyeClose.png">
                </div>
				<p class="error-text" id="AlertText">
				<br>
	            </p>
                <p class="password-instructions">Your password should contain:</p>
                <div class="password-hints">
                    <span>8+ <br>Characters</span>
                    <span>AA <br>Uppercase</span>
                    <span>aa<br> Lowercase</span>
                    <span>123<br> Number</span>
                    <span>&$#<br> Symbol</span>
                </div>

                <button type="button" class="continue-btn" onclick="jChangePswd()">Continue</button>
            </form>
          </div>		
	  </div>
	</div>		    
</body>
<script type="text/javascript">
	let mySessionEnd;	
	window.onload = jInitMe;
	document.onmousemove = resetTimer;
	document.onmousedown = resetTimer; 
	document.ontouchstart = resetTimer;
	document.onclick = resetTimer; 
	document.onkeypress = resetTimer;
	document.addEventListener('scroll', resetTimer, true); 
	T1=self.F1.T1, T2=self.F1.T2,T3=self.F1.T3
	let AlertText=document.getElementById("AlertText");

	function jInitMe(){
		T2.focus();
		restTimer();
	}
	function jTogglePassword(e){
		let tBox=e.target.previousElementSibling;
		if(tBox.type=="password"){
			tBox.type="text";
			event.target.src = "./assets/images/eyeOpen.png";
		}
		else{
			tBox.type="password";
			event.target.src = "./assets/images/eyeClose.png";
		}
	}
	function jEnterKey(event){
		if(event.which === 13){
				event.preventDefault();
				jChangePswd();
			}
	}

	function jChangePswd(){
		AlertText.innerHTML=""
	    const regex = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[!@#$%^&*(),.?":{}|<>])[A-Za-z\d!@#$%^&*(),.?":{}|<>]{8,}$/;
		
		if ((T2.value!=T3.value)){
			AlertText.innerHTML="The passwords do not match"
		}
		if ((T2.value.length<8)&&(T2.value.length<8)){
			AlertText.innerHTML="The password created is too short!"	
		}
		if (regex.test(T2.value)){
		} else { 
			AlertText.innerHTML="Please enter a valid password"
		} 
		if ((T2.value=="")||(T3.value=="")){
			AlertText.innerHTML="Please fill both fields"
		}
		#server(..cContinue(T2.value,AlertText.innerHTML))# 
	}
	function resetTimer(){
		clearTimeout(mySessionEnd);
		mySessionEnd = setTimeout(jLockDown, 3600000);
	}
	function clearTimer(){
		clearTimeout(mySessionEnd);
	}
	function jLockDown(){
		#server(..cLockDown())#
	}
</script>
<script language="cache" method="cContinue" arguments="d1,d2:%String">
	if d2=""{
		d SetNewPassword^trialResetPassword
		}
	else {}
</script>

</html>
