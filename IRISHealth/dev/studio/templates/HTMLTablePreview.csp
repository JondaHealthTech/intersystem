<csp:class DOMAIN="%TemplateMessages">
<html>
<head>

<title>#($$$Text("HTML Table Wizard Preview"))#</title>

<style type="text/css">
<!--
-->
</style>

<script language="JavaScript" type="text/javascript">
function btnCancel() {
	opener.cspPopupWindow = null;
	window.close();
	return true;
}

</script>



</head>
<body>
<script language="cache" runat="server">
	Do ##class(%template.htmlcolor).DrawTitle($$$Text("Table Preview"))
</script>
<script language="Cache" runat="server">
 Write "<table"
 Write:($get(%request.Data("bgcolor",1))'="") " bgcolor=""",$$$HTMLENCODE(%request.Data("bgcolor",1)),""""
 Write:($get(%request.Data("border",1))'="") " border=""",$$$HTMLENCODE(%request.Data("border",1)),""""
 Write:($get(%request.Data("cols",1))'="") " cols=""",$$$HTMLENCODE(%request.Data("cols",1)),""""
 Write:($get(%request.Data("cellpadding",1))'="") " cellpadding=""",$$$HTMLENCODE(%request.Data("cellpadding",1)),""""
 Write:($get(%request.Data("cellspacing",1))'="") " cellspacing=""",$$$HTMLENCODE(%request.Data("cellspacing",1)),""""
 Write ">",!
 
 Set tRows = +$get(%request.Data("rows",1),1)
 Set tRows = $S(tRows<0:0,tRows>1000:1000,1:tRows)
 Set tCols = +$get(%request.Data("cols",1),1)
 Set tCols = $S(tCols<0:0,tCols>100:100,1:tCols)

 If ($get(%request.Data("headers",1)) = 1) {
	Write "<tr>"
	For c = 1:1:tCols {
		Write "<th>",c,"</th>"
	}
	Write "</tr>",!
 }

 For r = 1:1:tRows {
	Write "<tr>"
	For c = 1:1:tCols {
		Write "<td>",$$$HTMLENCODE($get(%request.Data("content",1))),"</td>"
	}
	Write "</tr>",!
 }
 
 Write "</table>",!
</script>

<hr>
<form name="theForm">
<div align="center">

<input type="button" name="OK" VALUE=" OK " onclick="btnCancel();" textid="">
</div>
</form>

</body>
</html>
